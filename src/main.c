#include <gb/gb.h>
#include <stdio.h>
#include <gb/console.h>
#include <stddef.h>
#include "../include/cbtfx.h"
int joypad_p();
uint8_t menu_counter = 0;
uint8_t joypad_last_frame = 0;
uint8_t joypad_current_frame = 0;

// SFX data
// These are (painfully) converted SFX from FX Hammer, note that FX Hammer's pan values are inverted in the editor

// Whip-like sound
const unsigned char SFX_00[][CBTFX_LENGTH] = {
	CBTFX_FRAME(02, PAN_CENTER, 0x0f, 0, FX_Gs2, PAN_CENTER, 0x0f, 0x50),
	CBTFX_FRAME(01, PAN_CENTER, 0x0f, 1, FX_Fs2, PAN_CENTER, 0x08, 0x30),
	CBTFX_FRAME(01, PAN_CENTER, 0x0f, 1, FX_E_2, PAN_CENTER, 0x0f, 0x70),
	CBTFX_FRAME(01, PAN_CENTER, 0x0e, 2, FX_D_2, PAN_CENTER, 0x04, 0x30),
	CBTFX_FRAME(01, PAN_CENTER, 0x0d, 2, FX_C_2, PAN_CENTER, 0x02, 0x20),
	CBTFX_FRAME(02, PAN_CENTER, 0x0c, 2, FX_B_1, PAN_CENTER, 0x01, 0x10),
	CBTFX_FRAME(02, PAN_CENTER, 0x0b, 2, FX_A_1, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_RIGHT, 0x04, 0, FX_Gs2, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_RIGHT, 0x04, 1, FX_Fs2, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_RIGHT, 0x04, 1, FX_E_2, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_LEFT, 0x04, 2, FX_D_2, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_LEFT, 0x03, 2, FX_C_2, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_LEFT, 0x02, 2, FX_B_1, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_LEFT, 0x01, 2, FX_A_1, PAN_CENTER, 0x00, 0x00)
};

// Jump/Whoop sound
const unsigned char SFX_01[][CBTFX_LENGTH] = {
	CBTFX_FRAME(01, PAN_CENTER, 0x0f, 2, FX_E_1, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_CENTER, 0x0f, 2, FX_Gs1, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_CENTER, 0x0f, 2, FX_C_2, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_CENTER, 0x0e, 2, FX_E_2, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_CENTER, 0x0d, 2, FX_Gs2, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_CENTER, 0x0c, 2, FX_C_3, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_CENTER, 0x0b, 2, FX_E_3, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_LEFT, 0x04, 2, FX_E_1, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_LEFT, 0x04, 2, FX_Gs1, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_LEFT, 0x04, 2, FX_C_2, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_RIGHT, 0x04, 2, FX_E_2, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_RIGHT, 0x03, 2, FX_Gs2, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_RIGHT, 0x02, 2, FX_C_3, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_RIGHT, 0x01, 2, FX_E_3, PAN_CENTER, 0x00, 0x00)
};

// Start/Pause-like sound
const unsigned char SFX_02[][CBTFX_LENGTH] = {
	CBTFX_FRAME(01, PAN_CENTER, 0x0f, 1, FX_C_5, PAN_CENTER, 0x08, 0x50),
	CBTFX_FRAME(03, PAN_CENTER, 0x0f, 2, FX_C_4, PAN_CENTER, 0x03, 0x30),
	CBTFX_FRAME(01, PAN_CENTER, 0x0f, 1, FX_E_5, PAN_CENTER, 0x03, 0x20),
	CBTFX_FRAME(03, PAN_CENTER, 0x0f, 2, FX_E_4, PAN_CENTER, 0x02, 0x20),
	CBTFX_FRAME(02, PAN_CENTER, 0x08, 1, FX_E_4, PAN_CENTER, 0x02, 0x20),
	CBTFX_FRAME(02, PAN_CENTER, 0x04, 0, FX_E_4, PAN_CENTER, 0x01, 0x10),
	CBTFX_FRAME(01, PAN_RIGHT, 0x06, 1, FX_C_5, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(03, PAN_RIGHT, 0x06, 2, FX_C_4, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_LEFT, 0x06, 1, FX_E_5, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(03, PAN_LEFT, 0x06, 2, FX_E_4, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_LEFT, 0x04, 1, FX_E_4, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_LEFT, 0x02, 0, FX_E_4, PAN_CENTER, 0x00, 0x00)
};

// Start/Pause-like sound... Again
const unsigned char SFX_03[][CBTFX_LENGTH] = {
	CBTFX_FRAME(01, PAN_CENTER, 0x0f, 0, FX_E_5, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(03, PAN_CENTER, 0x0f, 2, FX_E_4, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_CENTER, 0x0f, 0, FX_Fs5, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(03, PAN_CENTER, 0x0f, 2, FX_Fs4, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_CENTER, 0x0f, 0, FX_Gs5, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(03, PAN_CENTER, 0x0f, 2, FX_Gs4, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_CENTER, 0x05, 0, FX_E_5, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(03, PAN_CENTER, 0x05, 2, FX_E_4, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_CENTER, 0x05, 0, FX_Fs5, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(03, PAN_CENTER, 0x05, 2, FX_Fs4, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_CENTER, 0x05, 0, FX_Gs5, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(03, PAN_CENTER, 0x05, 2, FX_Gs4, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_CENTER, 0x02, 0, FX_E_5, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(03, PAN_CENTER, 0x02, 2, FX_E_4, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_CENTER, 0x02, 0, FX_Fs5, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(03, PAN_CENTER, 0x02, 2, FX_Fs4, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_CENTER, 0x02, 0, FX_Gs5, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(03, PAN_CENTER, 0x02, 2, FX_Gs4, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_LEFT, 0x01, 0, FX_E_5, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(03, PAN_LEFT, 0x01, 2, FX_E_4, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_LEFT, 0x01, 0, FX_Fs5, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(03, PAN_LEFT, 0x01, 2, FX_Fs4, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_LEFT, 0x01, 0, FX_Gs5, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(03, PAN_LEFT, 0x01, 2, FX_Gs4, PAN_CENTER, 0x00, 0x00)
};

// Button pressed sound
const unsigned char SFX_04[][CBTFX_LENGTH] = {
	CBTFX_FRAME(01, PAN_CENTER, 0x0f, 2, FX_C_3, PAN_CENTER, 0x08, 0x50),
	CBTFX_FRAME(02, PAN_CENTER, 0x0f, 2, FX_C_2, PAN_CENTER, 0x03, 0x30),
	CBTFX_FRAME(01, PAN_CENTER, 0x0f, 2, FX_E_3, PAN_CENTER, 0x03, 0x20),
	CBTFX_FRAME(02, PAN_CENTER, 0x0f, 2, FX_E_2, PAN_CENTER, 0x02, 0x20),
	CBTFX_FRAME(01, PAN_CENTER, 0x0f, 2, FX_E_2, PAN_CENTER, 0x02, 0x20),
	CBTFX_FRAME(02, PAN_CENTER, 0x02, 2, FX_E_2, PAN_CENTER, 0x01, 0x10),
	CBTFX_FRAME(01, PAN_LEFT, 0x04, 2, FX_E_2, PAN_RIGHT, 0x03, 0x50),
	CBTFX_FRAME(02, PAN_LEFT, 0x04, 2, FX_C_2, PAN_RIGHT, 0x02, 0x30),
	CBTFX_FRAME(01, PAN_LEFT, 0x04, 2, FX_E_3, PAN_RIGHT, 0x01, 0x20),
	CBTFX_FRAME(03, PAN_LEFT, 0x04, 2, FX_E_2, PAN_RIGHT, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_LEFT, 0x04, 2, FX_E_2, PAN_RIGHT, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_LEFT, 0x01, 2, FX_E_2, PAN_RIGHT, 0x00, 0x00)
};

// Explosion-like sound
const unsigned char SFX_05[][CBTFX_LENGTH] = {
	CBTFX_FRAME(01, PAN_CENTER, 0x0f, 2, FX_E_1, PAN_CENTER, 0x0f, 0x50),
	CBTFX_FRAME(03, PAN_CENTER, 0x0f, 2, FX_C_1, PAN_CENTER, 0x0f, 0x80),
	CBTFX_FRAME(01, PAN_CENTER, 0x0f, 2, FX_As0, PAN_CENTER, 0x0f, 0x30),
	CBTFX_FRAME(02, PAN_CENTER, 0x0f, 2, FX_Gs0, PAN_CENTER, 0x0f, 0x60),
	CBTFX_FRAME(03, PAN_CENTER, 0x0f, 2, FX_Fs0, PAN_CENTER, 0x0f, 0x70),
	CBTFX_FRAME(02, PAN_CENTER, 0x0f, 2, FX_F_0, PAN_CENTER, 0x0f, 0x40),
	CBTFX_FRAME(04, PAN_CENTER, 0x0f, 2, FX_E_0, PAN_CENTER, 0x0a, 0x60),
	CBTFX_FRAME(02, PAN_CENTER, 0x0f, 2, FX_Ds0, PAN_CENTER, 0x0c, 0x70),
	CBTFX_FRAME(02, PAN_CENTER, 0x08, 2, FX_D_0, PAN_CENTER, 0x08, 0x50),
	CBTFX_FRAME(02, PAN_CENTER, 0x04, 2, FX_Cs0, PAN_CENTER, 0x04, 0x20),
	CBTFX_FRAME(02, PAN_CENTER, 0x01, 2, FX_C_0, PAN_CENTER, 0x05, 0x50),
	CBTFX_FRAME(02, PAN_CENTER, 0x00, 0, FX_C_0, PAN_CENTER, 0x05, 0x40),
	CBTFX_FRAME(04, PAN_CENTER, 0x00, 0, FX_C_0, PAN_CENTER, 0x03, 0x30),
	CBTFX_FRAME(05, PAN_CENTER, 0x00, 0, FX_C_0, PAN_CENTER, 0x02, 0x20),
	CBTFX_FRAME(07, PAN_CENTER, 0x00, 0, FX_C_0, PAN_CENTER, 0x01, 0x20)
};

// Another jump-like sound
const unsigned char SFX_06[][CBTFX_LENGTH] = {
	CBTFX_FRAME(01, PAN_CENTER, 0x0f, 2, FX_Gs2, PAN_CENTER, 0x0f, 0x50),
	CBTFX_FRAME(01, PAN_CENTER, 0x0f, 2, FX_E_2, PAN_CENTER, 0x08, 0x80),
	CBTFX_FRAME(01, PAN_CENTER, 0x0f, 2, FX_D_2, PAN_CENTER, 0x06, 0x30),
	CBTFX_FRAME(01, PAN_CENTER, 0x0f, 2, FX_C_2, PAN_CENTER, 0x04, 0x60),
	CBTFX_FRAME(01, PAN_CENTER, 0x0f, 2, FX_As1, PAN_CENTER, 0x02, 0x70),
	CBTFX_FRAME(01, PAN_CENTER, 0x0f, 2, FX_A_1, PAN_CENTER, 0x02, 0x40),
	CBTFX_FRAME(01, PAN_CENTER, 0x0f, 2, FX_As1, PAN_CENTER, 0x02, 0x60),
	CBTFX_FRAME(01, PAN_CENTER, 0x0f, 2, FX_C_2, PAN_CENTER, 0x01, 0x70),
	CBTFX_FRAME(01, PAN_CENTER, 0x0e, 2, FX_D_2, PAN_CENTER, 0x01, 0x50),
	CBTFX_FRAME(01, PAN_CENTER, 0x0c, 2, FX_E_2, PAN_CENTER, 0x01, 0x20),
	CBTFX_FRAME(01, PAN_CENTER, 0x08, 2, FX_Gs2, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_CENTER, 0x04, 2, FX_C_3, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_CENTER, 0x02, 2, FX_E_3, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_LEFT, 0x03, 2, FX_As1, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_LEFT, 0x03, 2, FX_C_2, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_LEFT, 0x03, 2, FX_D_2, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_LEFT, 0x02, 2, FX_E_2, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_LEFT, 0x02, 2, FX_Gs2, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_LEFT, 0x01, 2, FX_C_3, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_LEFT, 0x01, 2, FX_E_3, PAN_CENTER, 0x00, 0x00)
};

// Mysterious sound
const unsigned char SFX_07[][CBTFX_LENGTH] = {
	CBTFX_FRAME(02, PAN_CENTER, 0x0f, 2, FX_E_1, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_CENTER, 0x0f, 1, FX_E_1, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_CENTER, 0x0f, 1, FX_C_2, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_CENTER, 0x0f, 0, FX_C_2, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_CENTER, 0x0f, 0, FX_Gs1, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_CENTER, 0x0f, 1, FX_Gs1, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_CENTER, 0x0f, 1, FX_E_2, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_CENTER, 0x0f, 2, FX_E_2, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_CENTER, 0x0f, 2, FX_C_2, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_CENTER, 0x0f, 1, FX_C_2, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_CENTER, 0x0f, 1, FX_Gs2, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_CENTER, 0x0f, 0, FX_Gs2, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_CENTER, 0x0f, 0, FX_Gs1, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_CENTER, 0x0f, 1, FX_Gs1, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_CENTER, 0x0f, 1, FX_C_3, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_CENTER, 0x0f, 2, FX_C_3, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_CENTER, 0x0e, 2, FX_Gs2, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_CENTER, 0x0e, 1, FX_Gs2, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_CENTER, 0x0d, 1, FX_E_3, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_CENTER, 0x0c, 0, FX_E_3, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_CENTER, 0x0b, 0, FX_C_3, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_CENTER, 0x0a, 1, FX_C_3, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_CENTER, 0x09, 1, FX_Gs3, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_CENTER, 0x08, 2, FX_Gs3, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_CENTER, 0x07, 2, FX_E_3, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_CENTER, 0x06, 1, FX_E_3, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_CENTER, 0x05, 1, FX_C_4, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_CENTER, 0x04, 0, FX_C_4, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(04, PAN_CENTER, 0x03, 1, FX_Gs3, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(04, PAN_CENTER, 0x02, 2, FX_E_4, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(04, PAN_CENTER, 0x01, 1, FX_C_4, PAN_CENTER, 0x00, 0x00)
};

// Sword whip sound
const unsigned char SFX_08[][CBTFX_LENGTH] = {
	CBTFX_FRAME(02, PAN_CENTER, 0x00, 0, FX_C_0, PAN_CENTER, 0x0f, 0x40),
	CBTFX_FRAME(02, PAN_CENTER, 0x00, 0, FX_C_0, PAN_CENTER, 0x0f, 0x50),
	CBTFX_FRAME(02, PAN_CENTER, 0x00, 0, FX_C_0, PAN_CENTER, 0x0f, 0x60),
	CBTFX_FRAME(02, PAN_CENTER, 0x00, 0, FX_C_0, PAN_CENTER, 0x0f, 0x70),
	CBTFX_FRAME(02, PAN_CENTER, 0x00, 0, FX_C_0, PAN_CENTER, 0x0f, 0x80),
	CBTFX_FRAME(02, PAN_CENTER, 0x00, 0, FX_C_0, PAN_CENTER, 0x05, 0x40),
	CBTFX_FRAME(02, PAN_CENTER, 0x00, 0, FX_C_0, PAN_CENTER, 0x05, 0x50),
	CBTFX_FRAME(02, PAN_CENTER, 0x00, 0, FX_C_0, PAN_CENTER, 0x05, 0x60),
	CBTFX_FRAME(02, PAN_CENTER, 0x00, 0, FX_C_0, PAN_CENTER, 0x05, 0x70),
	CBTFX_FRAME(02, PAN_CENTER, 0x00, 0, FX_C_0, PAN_CENTER, 0x05, 0x80),
	CBTFX_FRAME(02, PAN_CENTER, 0x00, 0, FX_C_0, PAN_LEFT, 0x03, 0x40),
	CBTFX_FRAME(02, PAN_CENTER, 0x00, 0, FX_C_0, PAN_LEFT, 0x03, 0x50),
	CBTFX_FRAME(02, PAN_CENTER, 0x00, 0, FX_C_0, PAN_LEFT, 0x03, 0x60),
	CBTFX_FRAME(02, PAN_CENTER, 0x00, 0, FX_C_0, PAN_LEFT, 0x03, 0x70),
	CBTFX_FRAME(02, PAN_CENTER, 0x00, 0, FX_C_0, PAN_LEFT, 0x03, 0x80),
	CBTFX_FRAME(02, PAN_CENTER, 0x00, 0, FX_C_0, PAN_RIGHT, 0x02, 0x40),
	CBTFX_FRAME(02, PAN_CENTER, 0x00, 0, FX_C_0, PAN_RIGHT, 0x02, 0x50),
	CBTFX_FRAME(02, PAN_CENTER, 0x00, 0, FX_C_0, PAN_RIGHT, 0x02, 0x60),
	CBTFX_FRAME(02, PAN_CENTER, 0x00, 0, FX_C_0, PAN_RIGHT, 0x02, 0x70),
	CBTFX_FRAME(02, PAN_CENTER, 0x00, 0, FX_C_0, PAN_RIGHT, 0x02, 0x80)
};

// Fart
const unsigned char SFX_09[][CBTFX_LENGTH] = {
	CBTFX_FRAME(03, PAN_CENTER, 0x0f, 0, FX_D_1, PAN_CENTER, 0x0f, 0x80),
	CBTFX_FRAME(03, PAN_CENTER, 0x0f, 2, FX_Cs0, PAN_CENTER, 0x06, 0x40),
	CBTFX_FRAME(03, PAN_CENTER, 0x0f, 1, FX_C_0, PAN_CENTER, 0x03, 0x30),
	CBTFX_FRAME(03, PAN_CENTER, 0x0f, 0, FX_C_0, PAN_CENTER, 0x01, 0x20),
	CBTFX_FRAME(03, PAN_CENTER, 0x0f, 1, FX_C_0, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(03, PAN_CENTER, 0x0f, 2, FX_C_0, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(03, PAN_CENTER, 0x0f, 1, FX_C_0, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(03, PAN_CENTER, 0x0f, 0, FX_C_0, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(03, PAN_CENTER, 0x0f, 1, FX_C_0, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(02, PAN_CENTER, 0x0c, 2, FX_Cs0, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_CENTER, 0x08, 2, FX_D_0, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_CENTER, 0x06, 2, FX_Ds0, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_CENTER, 0x04, 1, FX_E_0, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_CENTER, 0x02, 1, FX_F_0, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_CENTER, 0x01, 1, FX_Fs0, PAN_CENTER, 0x00, 0x00),
	CBTFX_FRAME(01, PAN_CENTER, 0x01, 1, FX_Gs0, PAN_CENTER, 0x00, 0x00),
};

const unsigned char * SFX_list[] = { &SFX_00[0][0], &SFX_01[0][0], &SFX_02[0][0], &SFX_03[0][0], &SFX_04[0][0], &SFX_05[0][0], &SFX_06[0][0], &SFX_07[0][0], &SFX_08[0][0], &SFX_09[0][0] };
const unsigned char SFX_length[] = { ARRAY_LEN(SFX_00), ARRAY_LEN(SFX_01), ARRAY_LEN(SFX_02), ARRAY_LEN(SFX_03), ARRAY_LEN(SFX_04), ARRAY_LEN(SFX_05), ARRAY_LEN(SFX_06),ARRAY_LEN(SFX_07), ARRAY_LEN(SFX_08), ARRAY_LEN(SFX_09) };

int joypad_p(){
    joypad_last_frame = joypad_current_frame;
    joypad_current_frame = joypad();
    return (joypad_current_frame & ~joypad_last_frame);
}

void update_screen(){
	cls();
	gotoxy(0, 0);
    printf(" \n  ");
	printf("CBT-FX DEMO CART");

	printf("\n\n\n\n\n\n       SFX_%hx", menu_counter);

	printf("\n\n\n\n\n\n\n\n Press <- and -> to  pick and A to play");
}

void main(void){

    // Enable audio output
    NR52_REG = 0x80;
    NR51_REG = 0xFF;
    NR50_REG = 0x77;
    
    __critical {
        add_VBL(CBTFX_update);
    }

	update_screen();

	while(1){
		
		uint8_t controller = joypad_p();

		switch(controller){

			case J_A:
				CBTFX_init(SFX_list[menu_counter], SFX_length[menu_counter]);
				break;

			case J_LEFT:
				if(menu_counter == 0){
					menu_counter = 9;
				}
				else{
					menu_counter--;
				}
				update_screen();
				break;

			case J_RIGHT:
				if(menu_counter == 9){
					menu_counter = 0;
				}
				else{
					menu_counter++;
				}
				update_screen();
				break;

			default:
			break;

		}
		
		wait_vbl_done();
	}
}

